{% extends "budget/base.html" %}
{% block content %}
    <figure class="figure">
        <img src="{{ static('budget/example.jpg') }}" class="figure-img img-fluid rounded"  width=480 height=360 alt="График доходов-расходов не загрузился">
        <figcaption class="figure-caption">Здесь д.б. график доходов-расходов.</figcaption>
    </figure>

    {% set account_param = "" %}
    {% if current_account %}
        {% set account_param = "?bank_account=" ~ current_account %}
    {% endif %}
    <div class="btn-group" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-primary"><a class="dropdown-item" href="{{ url('expenditure-create') }}{{ account_param }}">Добавить расход</a></button>
        <button type="button" class="btn btn-primary"><a class="dropdown-item" href="{{ url('transfer-create') }}{{ account_param }}">Добавить перевод</a></button>
        <button type="button" class="btn btn-primary"><a class="dropdown-item" href="{{ url('income-create') }}{{ account_param }}">Добавить доход</a></button>
    </div>

    {% if object_list %}
        <ul class="list-group">
            {% for item in object_list %}
                {% set li_class = "list-group-item list-group-item-success" %}
                {% if item.signed_value <= 0 %}
                    {% set li_class = "list-group-item list-group-item-danger" %}
                {% endif %}
                <a href="{{ url('cashflow-edit', args=[item.id]) }}{{ account_param }}">
                <li class="{{ li_class }}">
                        {{ item.operation_date }}:
                        {{ item.account }}
                        {{ item.value }}
                        {{ item.comment }}
                </li>
                </a>
            {% endfor %}
        </ul>

        {% if is_paginated %}
            {# .... **Now the pagination section** .... #}
            {% set base_paginate_url = "?page=" %}
            {% if current_account %}
                {% set base_paginate_url = "?bank_account=" ~ current_account ~ "&page=" %}
            {% endif %}
            <nav aria-label="...">
                <ul class="pagination">
                    {% if page_obj.has_previous() %}
                        <li class="page-item">
                            <a class="page-link" href="{{ base_paginate_url }}{{ page_obj.previous_page_number() }}">Предыдущая</a>
                        </li>
                    {% endif %}
                    <li class="page-item active" aria-current="page">
                        <a class="page-link">{{ page_obj.number }}</a>
                    </li>
                    {% if page_obj.has_next() %}
                        <li class="page-item">
                            <a class="page-link" href="{{ base_paginate_url }}{{ page_obj.next_page_number() }}">Следующая</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        {% endif %}
    {% else %}
        <p>Таблица доходов/расходов пуста</p>
    {% endif %}

{% endblock %}
