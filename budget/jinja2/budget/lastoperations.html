{% extends "budget/base.html" %}
{% block content %}

    {% set account_param = "" %}
    {% if current_account %}
        {% set account_param = "?bank_account=" ~ current_account %}
    {% endif %}

    <div class="btn-group" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-outline-secondary"><a class="dropdown-item" href="{{ url('expenditure-create') }}{{ account_param }}">Добавить расход</a></button>
        <button type="button" class="btn btn-outline-secondary"><a class="dropdown-item" href="{{ url('transfer-create') }}{{ account_param }}">Добавить перевод</a></button>
        <button type="button" class="btn btn-outline-secondary"><a class="dropdown-item" href="{{ url('income-create') }}{{ account_param }}">Добавить доход</a></button>
    </div>

    {% if object_list %}
        <ul class="list-group">
            {% for item in object_list %}
                {% set li_class = "list-group-item list-group-item-success" %}
                {% if item.signed_value <= 0 %}
                    {% set li_class = "list-group-item list-group-item-danger" %}
                {% endif %}
                <a href="{{ url('cashflow-edit', args=[item.id]) }}{{ account_param }}">
                <li class="{{ li_class }}">
                        {{ item.operation_date }}:
                        {{ item.account }}
                        {{ item.value }}
                        {{ item.comment }}
                </li>
                </a>
            {% endfor %}
        </ul>

        {# .... **Now the pagination section** .... #}
        {% set base_paginate_url = "?page=" %}
        {% if current_account %}
            {% set base_paginate_url = "?bank_account=" ~ current_account ~ "&page=" %}
        {% endif %}

        {% if is_paginated %}
            <div class="pagination">
                <span class="page-links">
                    {% if page_obj.has_previous() %}
                        <a href="{{ base_paginate_url }}{{ page_obj.previous_page_number() }}">previous</a>
                    {% endif %}
                    <span class="page-current">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                    </span>
                    {% if page_obj.has_next() %}
                        <a href="{{ base_paginate_url }}{{ page_obj.next_page_number() }}">next</a>
                    {% endif %}
                </span>
            </div>
        {% endif %}
    {% else %}
        <p>Таблица доходов/расходов пуста</p>
    {% endif %}

{% endblock %}
